<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>smartassert by smarttested</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>smartassert</h1>
        <h2>Useful assertion utilities based on Hamcrest and Google Guava&#39;s Predicates</h2>
        <a href="https://github.com/smarttested/smartassert" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a name="smartasserts-" class="anchor" href="#smartasserts-"><span class="octicon octicon-link"></span></a>SmartAsserts <a href="https://travis-ci.org/smarttested/smartassert"><img src="https://travis-ci.org/smarttested/smartassert.svg?branch=master" alt="Build Status"></a>
</h1>

<p><em>SmartAsserts</em> is a set of utils which is used to provide the simplest way to perform 'hard' and 'soft' (delayed) assertions.</p>

<h2>
<a name="guidline" class="anchor" href="#guidline"><span class="octicon octicon-link"></span></a>Guidline:</h2>

<ol>
<li>
<a href="#maven-dependency">Maven Dependency</a> </li>
<li><strong><a href="#how-to">HOW TO (As simple as it is possible)</a></strong></li>
<li><a href="#hard-assertions">Hard Assertions</a></li>
<li><a href="#soft-assertions">Soft Assertions</a></li>
<li><a href="#testng-integration">TestNG integration</a></li>
<li><a href="#predicates-and-predefined-validators">Predicates and Predefined Validators</a></li>
</ol><h2>
<a name="maven-dependency" class="anchor" href="#maven-dependency"><span class="octicon octicon-link"></span></a>Maven Dependency</h2>

<p>Last version:</p>

<div class="highlight highlight-xml"><pre><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.smarttested<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>smartassert<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.0.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>

<h2>
<a name="how-to" class="anchor" href="#how-to"><span class="octicon octicon-link"></span></a>HOW-TO</h2>

<div class="highlight highlight-java"><pre><span class="cm">/* Put annotation to let TestNG know you gonna use SmartAssert */</span>
<span class="nd">@Listeners</span><span class="o">(</span><span class="n">SoftValidationMethodListener</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">YourUnitTest</span>
<span class="o">{</span>


   <span class="nd">@Test</span>
   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testYourBusinessLogic</span><span class="o">()</span>
   <span class="o">{</span>
      <span class="cm">/* Add validation of logic you wonna check */</span>

      <span class="n">SmartAssert</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="n">Lists</span><span class="o">.</span><span class="na">newArrayList</span><span class="o">(</span><span class="s">"one"</span><span class="o">,</span> <span class="s">"two"</span><span class="o">),</span> <span class="n">CoreMatchers</span><span class="o">.</span><span class="na">hasItem</span><span class="o">(</span><span class="s">"three"</span><span class="o">),</span> <span class="s">"There is no 'three'!"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">assertSoft</span><span class="o">();</span>
      <span class="n">SmartAssert</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="n">CoreMatchers</span><span class="o">.</span><span class="na">is</span><span class="o">(</span><span class="kc">false</span><span class="o">),</span> <span class="s">"True is not false!"</span><span class="o">).</span><span class="na">assertSoft</span><span class="o">();</span>

      <span class="cm">/* add another validations you need. First one won't fail this test */</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Validations failed, but test still works!"</span><span class="o">)</span>
   <span class="o">}</span>

   <span class="cm">/* Enjoy! Once test is finished, it will fail with all failed validations it had! */</span>
<span class="o">}</span>
</pre></div>

<h2>
<a name="hard-assertions" class="anchor" href="#hard-assertions"><span class="octicon octicon-link"></span></a>Hard Assertions</h2>

<p>Hard assertions is basically assertions you always used before. For example, </p>

<div class="highlight highlight-java"><pre><span class="n">org</span><span class="o">.</span><span class="na">testng</span><span class="o">.</span><span class="na">Assert</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
</pre></div>

<p>Let's assume we have some BigDecimal object and need to validate several fields:</p>

<div class="highlight highlight-java"><pre><span class="n">BigDecimal</span> <span class="n">decimal</span> <span class="o">=</span> <span class="n">BigDecimal</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(-</span><span class="mf">0.05</span><span class="o">);</span>

<span class="cm">/* check value is positive. Provided value is negative, so we've got error assertion here */</span>
<span class="n">Assert</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">(</span><span class="s">"Positive value is expected!"</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">decimal</span><span class="o">.</span><span class="na">signum</span><span class="o">());</span>

<span class="cm">/* check value has scale == 1. Provided value's scale is '2', so we've got error assertion here */</span>
<span class="n">Assert</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">(</span><span class="s">"Incorrect decimal scale!"</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">decimal</span><span class="o">.</span><span class="na">scale</span><span class="o">());</span>
</pre></div>

<p>In this case test will fail on first assertion once provided object is not positive, but after test you don't know whether test object has right scale! Another words, <strong>second assert is not performed</strong>. To solve this issue you might do something like:</p>

<div class="highlight highlight-java"><pre><span class="n">BigDecimal</span> <span class="n">decimal</span> <span class="o">=</span> <span class="n">BigDecimal</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(-</span><span class="mf">0.05</span><span class="o">);</span>
<span class="n">StringBuilder</span> <span class="n">errors</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="o">();</span>

<span class="cm">/* check value is positive. Provided value is negative, so we've got error assertion here */</span>
<span class="k">if</span> <span class="o">(</span><span class="mi">1</span> <span class="o">!=</span> <span class="n">decimal</span><span class="o">.</span><span class="na">signum</span><span class="o">()){</span>
   <span class="n">errors</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"Positive value is expected!"</span><span class="o">);</span>
<span class="o">}</span>

<span class="cm">/* check value has scale == 1. Provided value's scale is '2', so we've got error assertion here */</span>
<span class="k">if</span> <span class="o">(</span><span class="mi">1</span> <span class="o">!=</span> <span class="n">decimal</span><span class="o">.</span><span class="na">scale</span><span class="o">()){</span>
   <span class="n">errors</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"Incorrect decimal scale!"</span><span class="o">);</span>
<span class="o">}</span>

<span class="n">Assert</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">(</span><span class="n">errors</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span> <span class="mi">0</span> <span class="o">==</span> <span class="n">errors</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
</pre></div>

<p>This is not perfect way to solve issue obviously :) </p>

<p>So, problem described above is actually what <a href="#soft-assertions">Soft Assertions</a> are doing for you.</p>

<h2>
<a name="soft-assertions" class="anchor" href="#soft-assertions"><span class="octicon octicon-link"></span></a>Soft Assertions</h2>

<p>Let's try to re-write example above in soft-assert style:</p>

<div class="highlight highlight-java"><pre><span class="n">BigDecimal</span> <span class="n">decimal</span> <span class="o">=</span> <span class="n">BigDecimal</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(-</span><span class="mf">0.05</span><span class="o">);</span>

<span class="cm">/* check value is positive. Provided value is negative, but we haven't got error */</span>
<span class="n">SmartAssert</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="n">decimal</span><span class="o">.</span><span class="na">signum</span><span class="o">(),</span> <span class="n">CoreMatchers</span><span class="o">.</span><span class="na">is</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span> <span class="s">"Positive value is expected!"</span><span class="o">).</span><span class="na">assertSoft</span><span class="o">();</span>

<span class="cm">/* check value has scale == 1. Provided value's scale is '2', so we haven't got error assertion here */</span>
<span class="n">SmartAssert</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="n">decimal</span><span class="o">.</span><span class="na">scale</span><span class="o">(),</span> <span class="n">CoreMatchers</span><span class="o">.</span><span class="na">is</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span> <span class="s">"Incorrect decimal scale!"</span><span class="o">).</span><span class="na">assertSoft</span><span class="o">();</span>

<span class="cm">/* Here is place were real assertion will be thrown */</span>
<span class="n">SmartAssert</span><span class="o">.</span><span class="na">validateSoftAsserts</span><span class="o">();</span>
</pre></div>

<p>Using smartassert you are able to write assertions in junit/testNG style, but perform real validation on demand (basically, at the end of the method). All failures will be accumulated into one:</p>

<pre><code>com.smarttested.qa.smartassert.SoftAssertException: The following assert has been failed:  
Positive value is expected!  
Expected: is &lt;1&gt;  
     but: was &lt;-1&gt;  
Incorrect decimal scale!  
Expected: is &lt;1&gt;  
     but: was &lt;2&gt;  
    at com.smarttested.qa.smartassert.SoftFailuresHolder.getException(SoftFailuresHolder.java:62)  
    at com.smarttested.qa.smartassert.SoftFailuresHolder.validate(SoftFailuresHolder.java:52)  
    at com.smarttested.qa.smartassert.SmartAssert.validateSoftAsserts(SmartAssert.java:134)  
    at com.smarttested.qa.smartassert.SoftAssertTest.testBigDecimal(SoftAssertTest.java:27)  
</code></pre>

<p>Actually, there is a still way to use hard asserts:</p>

<div class="highlight highlight-java"><pre><span class="n">SmartAssert</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="n">Predicates</span><span class="o">.</span><span class="na">alwaysFalse</span><span class="o">(),</span> <span class="s">"I'm an error!"</span><span class="o">).</span><span class="na">assertHard</span><span class="o">();</span>
</pre></div>

<p>or</p>

<div class="highlight highlight-java"><pre><span class="n">SmartAssert</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="n">Predicates</span><span class="o">.</span><span class="na">alwaysFalse</span><span class="o">(),</span> <span class="s">"I'm an error!"</span><span class="o">).</span><span class="na">assertHard</span><span class="o">(</span><span class="n">SomeYourCustomException</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</pre></div>

<p>if you wonna some custom exception to be raised here. </p>

<h2>
<a name="testng-integration" class="anchor" href="#testng-integration"><span class="octicon octicon-link"></span></a>TestNG Integration</h2>

<p>To avoid calling </p>

<div class="highlight highlight-java"><pre><span class="n">SmartAssert</span><span class="o">.</span><span class="na">validateSoftAsserts</span><span class="o">();</span>
</pre></div>

<p>we provided TestNG listener which will do that on each test method. Another words, if some test has some failures, they will be validated after methed/test execution. </p>

<div class="highlight highlight-java"><pre><span class="nd">@Listeners</span><span class="o">(</span><span class="n">SoftValidationMethodListener</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SoftValidationMethodListenerTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGuavaSoft</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">SmartAssert</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="n">Predicates</span><span class="o">.</span><span class="na">alwaysFalse</span><span class="o">(),</span> <span class="s">"I'm an error!"</span><span class="o">).</span><span class="na">assertSoft</span><span class="o">();</span>
        <span class="n">SmartAssert</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="n">Predicates</span><span class="o">.</span><span class="na">alwaysFalse</span><span class="o">(),</span> <span class="s">"it's ok"</span><span class="o">).</span><span class="na">assertSoft</span><span class="o">();</span>
        <span class="n">SmartAssert</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="n">Predicates</span><span class="o">.</span><span class="na">alwaysFalse</span><span class="o">(),</span> <span class="s">"I'm an second error!"</span><span class="o">).</span><span class="na">assertSoft</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

<p>This method fails with description of all three failed validations. 
Sometimes you need to write negative test which expects some error. SoftValidationMethodListener support default TestNG behavior so this test pass, because expected exception is specified in TestNG annotation:</p>

<div class="highlight highlight-java"><pre><span class="nd">@Listeners</span><span class="o">(</span><span class="n">SoftValidationMethodListener</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SoftValidationMethodListenerTest</span> <span class="o">{</span>

    <span class="nd">@Test</span><span class="o">(</span><span class="n">expectedExceptions</span> <span class="o">=</span> <span class="o">{</span><span class="n">SoftAssertException</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">SkipException</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGuavaSoft</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">SmartAssert</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="n">Predicates</span><span class="o">.</span><span class="na">alwaysFalse</span><span class="o">(),</span> <span class="s">"I'm an error!"</span><span class="o">).</span><span class="na">assertSoft</span><span class="o">();</span>
        <span class="n">SmartAssert</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="n">Predicates</span><span class="o">.</span><span class="na">alwaysFalse</span><span class="o">(),</span> <span class="s">"it's ok"</span><span class="o">).</span><span class="na">assertSoft</span><span class="o">();</span>
        <span class="n">SmartAssert</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="n">Predicates</span><span class="o">.</span><span class="na">alwaysFalse</span><span class="o">(),</span> <span class="s">"I'm an second error!"</span><span class="o">).</span><span class="na">assertSoft</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

<h2>
<a name="predicates-and-predefined-validators" class="anchor" href="#predicates-and-predefined-validators"><span class="octicon octicon-link"></span></a>Predicates and Predefined Validators</h2>

<p>A very good style of writing unit and functional tests is to prepare validators you need and do not duplicate them in each test. There is a two ways to do that. First, you can use built-in Hamcrest validators:</p>

<div class="highlight highlight-java"><pre><span class="n">SmartAssert</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="s">"hello world"</span><span class="o">,</span> <span class="n">CoreMatchers</span><span class="o">.</span><span class="na">containsString</span><span class="o">(</span><span class="s">"hello"</span><span class="o">),</span> <span class="s">"This validation is passing"</span><span class="o">).</span><span class="na">assertSoft</span><span class="o">();</span>
</pre></div>

<p>Hamcrest has a lot of validators which may cover almost all your needs. Of course, you can prepare your own validators by implementing Hamcrest's <code>org.hamcrest.Matcher</code> interface. More information you can find <a href="https://code.google.com/p/hamcrest/">here</a> </p>

<p>Another way to perform validation and making matchers is <a href="https://code.google.com/p/guava-libraries/wiki/FunctionalExplained#Predicates">Guava's Predicates</a></p>

<p>Let's consider the following example:</p>

<div class="highlight highlight-java"><pre><span class="nd">@Listeners</span><span class="o">(</span><span class="n">SoftValidationMethodListener</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SoftAssertTest</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Predicate</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">STRING_IN_UPPER_CASE</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Predicate</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;()</span> <span class="o">{</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">apply</span><span class="o">(</span><span class="n">String</span> <span class="n">input</span><span class="o">)</span> <span class="o">{</span>
            <span class="cm">/* validates all symbols in string are whitespaces or upper-case symbols */</span>
            <span class="k">return</span> <span class="n">CharMatcher</span><span class="o">.</span><span class="na">JAVA_UPPER_CASE</span><span class="o">.</span><span class="na">or</span><span class="o">(</span><span class="n">CharMatcher</span><span class="o">.</span><span class="na">WHITESPACE</span><span class="o">).</span><span class="na">matchesAllOf</span><span class="o">(</span><span class="n">input</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="cm">/* add toString just to have pretty error message if validator fail on this predicate */</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Upper case validator"</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">};</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testUpperCase</span><span class="o">()</span> <span class="o">{</span>
        <span class="cm">/* this gonna fail */</span>
        <span class="n">SmartAssert</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="s">"lower case"</span><span class="o">,</span> <span class="n">STRING_IN_UPPER_CASE</span><span class="o">,</span> <span class="s">"String is not in upper case"</span><span class="o">).</span><span class="na">assertSoft</span><span class="o">();</span>

        <span class="cm">/* this gonna pass */</span>
        <span class="n">SmartAssert</span><span class="o">.</span><span class="na">expect</span><span class="o">(</span><span class="s">"UPPER CASE"</span><span class="o">,</span> <span class="n">STRING_IN_UPPER_CASE</span><span class="o">,</span> <span class="s">"String is not in upper case"</span><span class="o">).</span><span class="na">assertSoft</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

<p>So, by creating your own matchers and predicates you can move your validation logic into separate logic layer and use across all project. You might also want to use this stuff via some dependency injection container (like Guice or Spring) and replace your validators depending on some conditions:</p>

<div class="highlight highlight-java"><pre>
    <span class="cm">/* you can have multiple implementations. For example, first one</span>
<span class="cm">     * can validate only upper case symbols, second one can pass</span>
<span class="cm">     * validation with digits and whitespaces, because they do not</span>
<span class="cm">     * have case at all. </span>
<span class="cm">     */</span>
    <span class="nd">@Inject</span>
    <span class="nd">@Named</span><span class="o">(</span><span class="s">"upperCaseValidator"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Predicate</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">upperCaseValidator</span><span class="o">;</span>
</pre></div>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/smarttested/smartassert/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/smarttested/smartassert/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/smarttested/smartassert"></a> is maintained by <a href="https://github.com/smarttested">smarttested</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
